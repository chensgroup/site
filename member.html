<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chen's Group</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Chen's Group</h1>
    <nav class="menu-zh">
      <a href="index.html">首頁</a>
      <a href="member.html">成員</a>
      <a href="research.html">研究</a>
      <a href="course.html">課程</a>
      <a href="resource.html">資源</a>
      <a href="event.html">活動</a>
      <a href="index_en.html">English</a>
    </nav>
  </header>

  <main>
    <h2>現任成員<span style="font-size: 14px; vertical-align: middle;"><br>點擊圖片以檢視詳細資訊</span></h2>

    <div class="photo-grid">
      <!-- 教授（可點開） -->
      <div class="person-card profile" tabindex="0"
           data-name="陳教授"
           data-title="合聘副教授"
           data-degree="國立臺灣大學 物理系博士<br>國立臺灣大學 物理系碩士<br>國立臺灣師範大學 地球科學系學士"
           data-office="S711"
           data-fields="奈米光學, 物理教學, 數理資優教育"
           data-expertise="臺大物理學博士；2013 年 SCI 論文被引用超過 1,600 次；專長奈米光電子學、數理資優教育；110 年臺師大教學優良獎；113 年教育部學術論文獎；2025 與 Ernesto Macaro 發表 EMI 專書論文。"
           data-experience="光電及奈米科學與技術實驗室（PNSTL）<br> 中央研究院天文暨天文物理研究所（SMA / ALMA）"
           data-phone="02-76543210"
           data-email="chens@uuuu.edu.tw"
           data-website="http://chen.blogspot.com/"
           data-cv="陳育霖，臺大物理學博士，一篇影響指數19.0的國際期刊(SCI) 論文，2013年刊登至今被引用超過1,600次，超過11%是近兩年內引用，是同領域論文引用平均數的120倍，下載超過38,000次，獲選2014超穎材料研究必讀的精選重要論文。另有一篇論文被美國科學促進會(AAAS)等超過30家國際媒體報導[相關報導]。專長奈米光電子學、數理資優教育。同時是長號手、管樂團指揮。曾任教國立臺灣大學物理學系，現任教於國立臺灣師範大學師資培育學院及物理學系，同時擔任臺師大物理雙語課程與國際物理教育(IBDP Physics)國際文憑教師培育(IBEC)協調員及授課教師。110年榮獲臺師大教學優良獎，113年度探究式科學雙語教學論文榮獲教育部領域教材教法研究學術論文獎。2025年與牛津大學Ernesto Macaro共同發表EMI專書論文。"
           data-photo="members/Yu Lim Chen/professor.png">
        <img src="members/Yu Lim Chen/professor.png" alt="Prof. Chen" />
        <p class="lang-zh"><strong>陳教授</strong><br>實驗室主持人</p>
      </div>

      <!-- 王小明（可點開，示範） -->
      <div class="person-card profile" tabindex="0"
           data-name="王小明"
           data-title="研究生"
           data-degree="國立範例大學 物理系學士"
           data-fields="量子資訊、計算物理"
           data-expertise="數值模擬、資料視覺化"
           data-experience="專題研究：拓樸量子計算"
           data-email="wang@uuuu.edu.tw"
           data-photo="members/Xiao Ming Wang/member1.png">
        <img src="members/Xiao Ming Wang/member1.png" alt="王小明 / Wang Xiaoming" />
        <p class="lang-zh"><strong>王小明</strong><br>研究生 (2024-)</p>
      </div>

      <div class="person-card profile" tabindex="0"
           data-name="陳苡銜"
           data-title="研究生"
           data-degree="國立範例大學 物理系學士"
           data-fields="量子資訊、計算物理"
           data-expertise="數值模擬、資料視覺化"
           data-experience="專題研究：拓樸量子計算"
           data-email="wang@uuuu.edu.tw"
           data-photo="members/Yi Hsien Chen/image.JPG">
        <img src="members/Yi Hsien Chen/image.JPG" alt="陳苡銜 / Yi Hsien Chen" />
        <p class="lang-zh"><strong>陳苡銜</strong><br>研究生 (2024-)</p>
      </div>
    </div>

    <h2>前成員<span style="font-size: 14px; vertical-align: middle;"><br>點擊圖片以檢視詳細資訊</span></h2>

    <div class="photo-grid">
      <!-- 其餘成員（先不開啟彈窗；之後要能點只要加 .profile 與 data-* 屬性） -->
      <div class="person-card">
        <img src="members/Xiao Bai Lin/member2.png" alt="林小白 / Lin Xiaobai" />
        <p class="lang-zh"><strong>林小白</strong><br>網站維護</p>
      </div>

      <div class="person-card">
        <img src="members/David Chang/member3.png" alt="張大偉 / Chang David" />
        <p class="lang-zh"><strong>張大偉</strong><br>課程助教</p>
      </div>

      <div class="person-card">
        <img src="members/Hsin Yi Hsu/member4.png" alt="許心怡 / Hsu Hsin-Yi" />
        <p class="lang-zh"><strong>許心怡</strong><br>課程助教</p>
      </div>

      <div class="person-card">
        <img src="members/Nai Wen Cheng/member5.png" alt="鄭乃文 / Cheng Nai-Wen" />
        <p class="lang-zh"><strong>鄭乃文</strong><br>研究生</p>
      </div>

      <div class="person-card">
        <img src="members/Chih Han Liu/member6.png" alt="劉址涵 / Liu Chih-Han" />
        <p class="lang-zh"><strong>劉址涵</strong><br>教學資源整理</p>
      </div>

      <div class="person-card">
        <img src="members/Cheng Han Tsai/member7.png" alt="蔡承翰 / Tsai Cheng-Han" />
        <p class="lang-zh"><strong>蔡承翰</strong><br>專題生</p>
      </div>
    </div>
  </main>

  <!-- 通用彈窗 -->
  <div class="modal" id="profile-modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal__panel">
      <!-- 手機置頂列（手機顯示、桌機隱藏：由 CSS 控制） -->
      <div class="modal__topbar" style="display:none;">
        <div class="name" id="m-name-mobile"></div>
        <button class="modal__close" aria-label="關閉">&times;</button>
      </div>

      <!-- 桌機右上角關閉（手機會隱藏：由 CSS 控制） -->
      <button class="modal__close" aria-label="關閉" title="關閉">&times;</button>

      <div class="modal__photo">
        <img id="m-photo" src="" alt="">
      </div>
      <div class="modal__body">
        <h2 id="m-name"></h2>
        <div class="modal__subtitle" id="m-title"></div>
        <div class="modal__info" id="m-info"></div>
        <div class="modal__actions" id="m-actions"></div>
      </div>
    </div>
  </div>

  <footer>
    <p>© 2025 Chen’s Group</p>
  </footer>

  <script>
  (() => {
    const modal = document.getElementById('profile-modal');
    const panel = modal.querySelector('.modal__panel');
    const closeBtns = modal.querySelectorAll('.modal__close');
    const topbar = modal.querySelector('.modal__topbar');

    const imgEl = document.getElementById('m-photo');
    const nameEl = document.getElementById('m-name');
    const nameMobileEl = document.getElementById('m-name-mobile');
    const titleEl = document.getElementById('m-title');
    const infoEl = document.getElementById('m-info');
    const actionsEl = document.getElementById('m-actions');
    const bodyEl = modal.querySelector('.modal__body');

    const label = {
      degree: '最高學歷：',
      office: 'Office：',
      fields: '研究領域：',
      expertise: '研究專長：',
      experience: '研究經歷：',
      phone: '電話：',
      email: '信箱：',
      website: '個人網站：',
      cv: '簡歷：'
    };

    // 真·滾動鎖（記住捲動位置並固定 body）
    let _scrollY = 0;
    function lockBodyScroll(){
      _scrollY = window.scrollY || document.documentElement.scrollTop || 0;
      document.documentElement.style.scrollBehavior = 'auto';
      document.body.style.setProperty('--scroll-lock', `-${_scrollY}px`);
      document.body.classList.add('no-scroll');
    }
    function unlockBodyScroll(){
      document.body.classList.remove('no-scroll');
      document.body.style.removeProperty('--scroll-lock');
      window.scrollTo(0, _scrollY);
      document.documentElement.style.scrollBehavior = '';
    }

    // 將屬性值中的 \n 轉成 <br>，讓你在 data-* 可用換行符
    function withLineBreaks(str){
      return (str || '').replace(/\n/g, '<br>');
    }

    function openModalFromCard(card){
      const data = {
        name: card.dataset.name || '',
        title: card.dataset.title || '',
        degree: card.dataset.degree || '',
        office: card.dataset.office || '',
        fields: card.dataset.fields || '',
        expertise: card.dataset.expertise || '',
        experience: card.dataset.experience || '',
        phone: card.dataset.phone || '',
        email: card.dataset.email || '',
        website: card.dataset.website || '',
        cv: card.dataset.cv || '',
        photo: card.dataset.photo || card.querySelector('img')?.src || ''
      };

      // 基本資料
      imgEl.src = data.photo;
      imgEl.alt = data.name ? data.name + ' 的照片' : 'Profile photo';
      nameEl.textContent = data.name;
      if (nameMobileEl) nameMobileEl.textContent = data.name;
      titleEl.textContent = data.title;

      // 清空、塞欄位
      infoEl.innerHTML = '';
      actionsEl.innerHTML = '';

      const rows = [
        ['degree', data.degree],
        ['office', data.office],
        ['fields', data.fields],
        ['expertise', data.expertise],
        ['experience', data.experience],
        ['phone', data.phone],
        ['email', data.email],
        ['website', data.website],
        ['cv', data.cv],
      ];

      rows.forEach(([key, val]) => {
        if (!val) return;
        const p = document.createElement('p');

        // 轉換換行
        const content = withLineBreaks(val);

        if (key === 'email') {
          p.innerHTML = `<strong>${label[key]}</strong><a href="mailto:${content}">${content}</a>`;
        } else if (key === 'website' || key === 'cv') {
          if (/^https?:\/\//i.test(content)) {
            p.innerHTML = `<strong>${label[key]}</strong><a href="${content}" target="_blank" rel="noopener">${content}</a>`;
          } else {
            p.innerHTML = `<strong>${label[key]}</strong>${content}`;
          }
        } else {
          p.innerHTML = `<strong>${label[key]}</strong>${content}`;
        }
        infoEl.appendChild(p);
      });

      // 手機顯示置頂列
      if (window.matchMedia('(max-width: 720px)').matches) {
        if (topbar) topbar.style.display = 'flex';
      } else {
        if (topbar) topbar.style.display = 'none';
      }

      // 開啟
      modal.style.display = 'block';
      modal.setAttribute('aria-hidden','false');
      lockBodyScroll();

      // 重設內容捲動位置
      if (bodyEl) bodyEl.scrollTop = 0;

      document.addEventListener('keydown', escToClose);
    }

    function closeModal(){
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden','true');
      unlockBodyScroll();
      document.removeEventListener('keydown', escToClose);
    }
    function escToClose(e){ if (e.key === 'Escape') closeModal(); }

    // 背景點擊關閉
    modal.addEventListener('click', e => { if (e.target === modal) closeModal(); });
    // 面板內阻止冒泡
    panel.addEventListener('click', e => e.stopPropagation());
    // 關閉按鈕
    closeBtns.forEach(btn => btn.addEventListener('click', closeModal));

    // iOS：只攔背景層觸控滾動，放行面板內
    modal.addEventListener('touchmove', (e) => {
      if (!e.target.closest('.modal__panel')) e.preventDefault();
    }, { passive: false });

    // 綁定所有可點卡片
    const clickableCards = document.querySelectorAll('.person-card.profile');
    clickableCards.forEach(card => {
      card.addEventListener('click', () => openModalFromCard(card));
      card.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openModalFromCard(card);
        }
      });
    });
  })();
  </script>
</body>
</html>
